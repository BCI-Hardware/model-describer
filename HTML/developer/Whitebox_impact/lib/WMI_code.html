!function(e){function t(r){if(a[r])return a[r].exports;var o=a[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var a=e.data.name;k.indexOf(a)>=0?(k.splice(k.indexOf(a),1),d3.select(this).attr("fill",F.heat[a])):(k.push(a),d3.select(this).attr("fill","#A7A8AA")),N.selectAll("*").remove();for(var r=0;r<f.AppData.length;r++)V(r)}function i(){P=document.getElementById("percentileCheck").checked,d3.select(".Chartcontainer").selectAll("*").remove(),D=T.getWidth(),d(f.AppData[0].Data[0].groupByVarName)}function p(){var e=c(),t=A.append("div").attr("class","dropdown");t.append("button").attr("class","dropbtn").html("<b>Group By:</b> "+w).append("span").style("float","right").html(" ▼");var a=t.append("div").attr("class","dropdown-content");a.selectAll("a").data(e).enter().append("a").html(function(e){return e}).attr("onclick",function(e){return"intializeTreeMap('"+e+"')"});A.append("div").attr("class","perc-check").html("<input id='percentileCheck' class='perc-checkinput' checked='true' onchange='togglePercentile()' type='checkbox'><label for='percentileCheck'>Percentiles</label>")}function n(e,t){setTimeout(function(){H=!0},300);var a=R.statData.filter(function(t){return t.groupByVarName==w&&t.groupByValue==e.data.name})[0],r=R.proportion.filter(function(t){return t.name==e.data.name})[0];E.style("opacity",1).style("left",d3.event.pageX+"px").style("top",d3.event.pageY+"px").style("color",F.heat[e]).html("Group <b>"+a.groupByValue+" </b> is "+r.perc+"% of the data and has an average error of <b>"+T.formatLabel(a.MSE)+"</b>")}function u(e,t){setTimeout(function(){H=!0},300);var a=R.statData.filter(function(t){return t.groupByVarName==w&&t.groupByValue==e.data.name})[0],r=R.proportion.filter(function(t){return t.name==e.data.name})[0];E.style("opacity",1).style("left",d3.event.pageX+"px").style("top",d3.event.pageY+"px").style("color",F.heat[e.data.name]).html("Group <b>"+a.groupByValue+" </b> is "+T.formatLabel(r.perc)+"% of the data and has an average error of <b>"+T.formatLabel(a.MSE)+"</b>")}function l(e,t){E.style("opacity",0)}function d(e){function t(e){return e.children?0:1}function a(e){return e.size}w=e,s(),d3.select(".dropbtn").html("<b>Group By:</b> "+w).append("span").style("float","right").html(" ▼");var r=y(w),i={top:50,right:15,bottom:30,left:60};L.selectAll("*").remove();var p=.8*T.getWidth()-.1*i.left-i.right-.1*T.getWidth(),d=200-i.top-i.bottom;L.attr("width",p),L.attr("height",d);var c=function(e){return d3.interpolateRgb(e,"#fff")(.2)},g=(d3.scaleOrdinal(d3.schemeCategory20.map(c)),d3.format(",d"),d3.treemap().tile(d3.treemapResquarify).size([p,d-20]).round(!0).paddingInner(2)),m=d3.hierarchy(r).eachBefore(function(e){e.data.id=(e.parent?e.parent.data.id+".":"")+e.data.name}).sum(a).sort(function(e,t){return t.data.name-e.data.name});R.proportion=m.data.children;var h=0;for(var B in R.proportion)h+=R.proportion[B].size;for(var B in R.proportion)R.proportion[B].perc=100*R.proportion[B].size/h;g(m);var S=L.append("g").attr("class","cell-group").attr("transform","translate(0,20)"),b=S.selectAll("g").data(m.leaves()).enter().append("g").attr("transform",function(e){return"translate("+e.x0+","+e.y0+")"});b.append("rect").attr("id",function(e){return e.data.id+" brdr"}).attr("x",-2).attr("y",-2).attr("class","borderpath").attr("width",function(e){return e.x1-e.x0+4}).attr("height",function(e){return e.y1-e.y0+4}).attr("fill",function(e){return"#53565A"}).style("cursor","pointer"),b.append("rect").attr("id",function(e){return e.data.id}).attr("class","rect").attr("width",function(e){return e.x1-e.x0}).attr("height",function(e){return e.y1-e.y0}).attr("fill",function(e){return F.heat[e.data.name]}).on("click",o).on("mouseenter",n).on("mouseout",l).on("mousemove",u).style("cursor","pointer"),b.append("text").attr("clip-path",function(e){return"url(#clip-"+e.data.id+")"}).attr("dx",10).attr("dy",20).text(function(e){if(e.x1-e.x0>100){var t=R.statData.filter(function(t){return t.groupByVarName==w&&t.groupByValue==e.data.name})[0],a=R.proportion.filter(function(t){return t.name==e.data.name})[0];return"Category: "+t.groupByValue+" ("+T.formatLabel(a.perc)+"%)"}return""}).style("fill","#fff"),b.append("text").attr("clip-path",function(e){return"url(#clip-"+e.data.id+")"}).attr("dx",10).attr("dy",40).text(function(e){if(e.x1-e.x0>100){var t=R.statData.filter(function(t){return t.groupByVarName==w&&t.groupByValue==e.data.name})[0];return"Average Error: "+T.formatLabel(t.MSE)}return""}).style("fill","#fff"),d3.selectAll("input").data([a,t],function(e){return e?e.name:this.value}),N.selectAll("*").remove();for(var Y=0;Y<f.AppData.length;Y++)V(Y)}function y(e){var t={name:"heatMap",children:[]},a=f.AppData[0].Data,r=a.filter(function(t){return t.groupByVarName==e}),o=R.statData.filter(function(t){return t.groupByVarName==e}),i=d3.nest().key(function(e){return e.groupByValue}).rollup(function(e){return e.length}).entries(r);return i.forEach(function(e){var a={};a.name=e.key,a.size=o.filter(function(t){return t.groupByValue==e.key})[0].Total,t.children.push(a)}),t.children=t.children.sort(T.sortDictionary),t}function c(){var e=[];return f.AppData.forEach(function(t){t.Data.forEach(function(t){e.indexOf(t.groupByVarName)<0&&e.push(t.groupByVarName)})}),e}function g(e,t,a,r){var o=e.filter(function(e){return e.groupByValue==a});if(100==t){var i=o[o.length-1][r];return T.formatLabel(i)}var p=t/100*(o.length+1),n=parseInt(p),i=o[n][r];return T.formatLabel(i)}function m(e,t,a){var r=d3.extent(e.map(function(e){return e[t]})),o={},i={};i.overEst="",i.underEst="",o.quartiles=[];for(var p=(d3.quantile(r,.25)-d3.min(r),1);p<=4;p++)for(var n in a){var u=a[n],l={};l.quarter=p,l.group=u;var d=g(e,25*(p-1),u,t),y=g(e,25*p,u,t);l.range=[d,y];var c=e.filter(function(e){return e[t]>=d&&e[t]<=y&&e.groupByValue==u});l.averageImpact=d3.mean(c.map(function(e){return e.predictedYSmooth})),l.medianImpact=d3.median(c.map(function(e){return e.predictedYSmooth})),l.estimate=Math.abs(d3.mean(c.map(function(e){return e.predictedYSmooth}))/d3.mean(c.map(function(e){return e.predictedYSmooth}))),l.estimate>=1?i.overEst+=T.formatLabel(d)+"-"+T.formatLabel(y)+", ":i.underEst+=T.formatLabel(d)+"-"+T.formatLabel(y)+", ",o.quartiles.push(l)}return i.lowest=d3.min(o.quartiles.map(function(e){return e.averageImpact})),i.highest=d3.max(o.quartiles.map(function(e){return e.averageImpact})),i.lowestGroup=o.quartiles.filter(function(e){return e.averageImpact==i.lowest})[0].group,i.lowestGroup=i.lowestGroup.indexOf("Bin")>=0?"for group "+i.lowestGroup.split("_")[1]:" for "+i.lowestGroup,i.highestGroup=o.quartiles.filter(function(e){return e.averageImpact==i.highest})[0].group,i.highestGroup=i.highestGroup.indexOf("Bin")>=0?"for group "+i.highestGroup.split("_")[1]:" for "+i.highestGroup,i.lowestQuartile=o.quartiles.filter(function(e){return e.averageImpact==i.lowest})[0].range,i.highestQuartile=o.quartiles.filter(function(e){return e.averageImpact==i.highest})[0].range,i.lowestRange=i.lowestQuartile,i.highestRange=i.highestQuartile,i.overAllAverageImpact=d3.mean(e.map(function(e){return e.predictedYSmooth})),i.overAllMedianImpact=d3.median(e.map(function(e){return e.predictedYSmooth})),i.diffMaxOverall=i.highest-i.overAllMedianImpact,i.diffMaxMin=i.highest-i.lowest,i}function h(e,t,a,r){var o=d3.extent(e.map(function(e){return e[t]}));console.log(e);var i={},p={};p.overEst="",p.underEst="",i.quartiles=[];var n=d3.quantile(o,.25)-d3.min(o);for(var u in r)for(var l in a){var d=r[u],y=a[l],c={};c.quarter=d,c.group=y;var g=e.filter(function(e){return e[t]==d&&e.groupByValue==y});c.averageImpact=d3.mean(g.map(function(e){return e.predictedYSmooth})),c.medianImpact=d3.median(g.map(function(e){return e.predictedYSmooth})),c.estimate=Math.abs(d3.mean(g.map(function(e){return e.predictedYSmooth}))/d3.mean(g.map(function(e){return e.predictedYSmooth}))),c.estimate>=1?p.overEst+=d+", ":p.underEst+=d+", ",i.quartiles.push(c)}return p.lowest=d3.min(i.quartiles.map(function(e){return e.averageImpact})),p.highest=d3.max(i.quartiles.map(function(e){return e.averageImpact})),p.lowestGroup=i.quartiles.filter(function(e){return e.averageImpact==p.lowest})[0].group,p.lowestGroup=p.lowestGroup.indexOf("Bin")>=0?"for group "+p.lowestGroup.split("_")[1]:" for "+p.lowestGroup,p.highestGroup=i.quartiles.filter(function(e){return e.averageImpact==p.highest})[0].group,p.highestGroup=p.highestGroup.indexOf("Bin")>=0?"for group "+p.highestGroup.split("_")[1]:" for "+p.highestGroup,p.lowestQuartile=i.quartiles.filter(function(e){return e.averageImpact==p.lowest})[0].quarter,p.highestQuartile=i.quartiles.filter(function(e){return e.averageImpact==p.highest})[0].quarter,p.lowestRange=[T.formatLabel(d3.min(o)+n*(p.lowestQuartile-1)),T.formatLabel(d3.min(o)+n*p.lowestQuartile)],p.highestRange=[T.formatLabel(d3.min(o)+n*(p.highestQuartile-1)),T.formatLabel(d3.min(o)+n*p.highestQuartile)],p.overAllAverageImpact=d3.mean(e.map(function(e){return e.predictedYSmooth})),p.overAllMedianImpact=d3.median(e.map(function(e){return e.predictedYSmooth})),p.diffMaxOverall=p.highest-p.overAllMedianImpact,p.diffMaxMin=p.highest-p.lowest,p}function s(){for(var e=[],t=0;t<f.AppData.length;t++){var a=f.AppData[t].Data.filter(function(e){return e.groupByVarName==w});if(a.length>0){var r=a[0],o=Object.keys(r).filter(function(e){return _.indexOf(e)<0})[0];F[o]={},F.heat={},a.forEach(function(t){e.indexOf(t.groupByValue)<0&&e.push(t.groupByValue)}),e.sort(T.sortAlphaNum),e.forEach(function(e,t){F[o][e]=C[t]})}}e.forEach(function(e,t){F.heat[e]=C[t]})}function B(){f.AppData.filter(function(e,t){"Accuracy"==e.Type&&(R.statData=e.Data,f.AppData.splice(t,1))})}function V(e){function t(){function t(r){function u(t,a){d3.selectAll(".layer"+e).style("opacity",.25),d3.selectAll(".path"+t+e).style("opacity",1).style("stroke","black").attr("stroke-width","1px")}function d(t,a){d3.selectAll(".layer"+e).style("opacity",1).attr("stroke-width","0")}function y(e,a){S[i].indexOf(e)>=0?(S[i].splice(S[i].indexOf(e),1),t(!1),d3.select(this).style("opacity",.5).style("background-color","#A7A8AA")):(S[i].push(e),t(!1),d3.select(this).style("opacity",1).style("background-color",F[i][e]))}function h(e){var t=a();E.style("left",function(){var e=this.getBoundingClientRect().width,t=d3.event.pageX;return p>e+t+25?d3.event.pageX+5+"px":d3.event.pageX-e-5<10?"10px":d3.event.pageX-e-5+"px"}).style("top",d3.event.pageY-28+"px").style("opacity",1),W.transition().style("opacity",1).attr("x1",v(t)+10).attr("x2",v(t)+10);var r=b.filter(function(e){return e[i]==t});E.html("Within the <span>"+e.key+" </span> group, the model believes that "+(V>=0?"increasing":"decreasing")+" <span>"+i+"</span> from <span> "+T.formatLabel(r[0][i])+" </span> to <span>"+T.formatLabel(parseFloat(r[0][i])+parseFloat(V))+"</span> leads to, on average, a <span>"+Math.abs(T.formatLabel(r[0][e.key]))+(T.formatLabel(r[0][e.key])>=0?" increase":" decrease")+"</span> in "+U)}function s(t){d3.selectAll(".layer"+e).style("opacity",1).attr("stroke-width",0),E.transition().style("opacity",0),H=!1,W.transition().style("opacity",0)}function f(t,r){var o=a();setTimeout(function(){H=!0},300);var n=b.filter(function(e){return e[i]==o});E.attr("class","colorClass"+e+r),E.transition().duration(200).delay(100).style("opacity",1),E.html("Within the <span>"+t.key+" </span> group, the model believes that "+(V>=0?"increasing":"decreasing")+" <span>"+i+"</span> from <span> "+T.formatLabel(n[0][i])+" </span> to <span>"+T.formatLabel(parseFloat(n[0][i])+parseFloat(V))+"</span> leads to, on average, a <span>"+Math.abs(T.formatLabel(n[0][t.key]))+(T.formatLabel(n[0][t.key])>=0?" increase":" decrease")+"</span> in "+U).style("left",function(){var e=this.getBoundingClientRect().width,t=d3.event.pageX;return p>e+t+25?d3.event.pageX+5+"px":d3.event.pageX-e-5<10?"10px":d3.event.pageX-e-5+"px"}).style("top",d3.event.pageY-28+"px"),E.style("color",F[i][t.key]),d3.selectAll(".layer"+e).style("opacity","0.4"),d3.select(this).style("opacity",1).style("stroke","black").attr("stroke-width","1px")}var I=0,x=0,z=[];b.filter(function(e){var t={};t[i]=e[i],S[i].forEach(function(a){t[a]=e[a]}),z.push(t)});var O=m(o,i,S[i]);B.html("<ul style='list-style-type:disc' > <li>Across all categories, the impact of <b>"+i+" </b> on <b>"+U+"</b> is lowest from <b> ["+O.lowestRange+"] </b> "+O.lowestGroup+" and highest from <b> ["+O.highestRange+"] </b> "+O.highestGroup+"</li> <li> The impact of <b>"+i+" </b>  on <b>"+U+"</b> from <b> ["+O.highestRange+"]  </b>"+O.highestGroup+" is  "+T.formatLabel(O.diffMaxOverall)+" higher than the overall median imapct and "+T.formatLabel(O.diffMaxMin)+" higher than the average impact from <b> ["+O.lowestRange+"] </b>"+O.lowestGroup+"</li> </ul>");var G=[];for(var q in X){var j=0,Q=0;for(var Z in S[i]){var J=S[i][Z],$=g(o,X[q],J,i),K=R.proportion.filter(function(e){return e.name==J})[0].perc/100;j+=$*K,Q+=K}G.push({percentile:X[q],value:T.formatLabel(j/Q)})}z=z.sort(function(e,t){return e[i]-t[i]}),v.domain(d3.extent(z,function(e){return e[i]}));var ee=d3.stack().keys(S[i].sort(T.sortAlphaNum)).order(d3.stackOrderAscending);ee(z).forEach(function(e){var t=0;e.forEach(function(e){t+=e[1],d3.min([e[0],e[1]])<I&&(I=d3.min([e[0],e[1]])),d3.max([e[0],e[1]])>x&&(x=d3.max([e[0],e[1]]))})}),A.domain([I,x]);var te=d3.axisBottom().scale(v);if(w.transition().duration(1e3).call(M),P){var ae=L.selectAll("line").data(G);ae.exit().remove(),ae.enter().append("line").style("opacity",1).attr("x1",function(e){return v(e.value)}).attr("y1",30*Y+40).attr("x2",function(e){return v(e.value)}).attr("y2",n+30*Y+20).attr("stroke","#75787B").attr("stroke-width","2px"),ae.transition().attr("x1",function(e){return v(e.value)}).attr("y1",30*Y+40).attr("x2",function(e){return v(e.value)}).attr("y2",n+30*Y+20).attr("stroke","#75787B").attr("stroke-width","2px");var re=C.selectAll("text").data(G);re.exit().remove(),re.enter().append("text").text(function(e){return e.percentile}).attr("transform",function(e,t){return"translate("+(v(e.value)-5)+",65)"}),re.transition().text(function(e){return e.percentile}).attr("transform",function(e,t){return"translate("+(v(e.value)-5)+",65)"})}k.selectAll(".path").remove();var oe=k.selectAll(".path").data(ee(z));oe.exit().transition().duration(500).remove(),oe.enter().append("path").attr("class",function(t,a){return"path layer"+t.key+" path"+t.key+e+" layer"+e}).attr("transform","translate(10,"+(30*Y+40)+")").on("mouseenter",f).on("mousemove",h).on("mouseout",s).attr("d",D).transition().duration(1e3).attr("d",N).attr("fill",function(e,t){return F[i][e.key]}).attr("cursor","pointer"),oe.attr("class",function(t,a){return"layer"+t.key+" path"+t.key+e+" layer"+e}).on("mouseenter",f).on("mousemove",h).on("mouseout",s).transition().duration(1e3).attr("d",N).attr("fill",function(e,t){return F[i][e.key]}).attr("transform","translate(10,"+(30*Y+40)+")").attr("cursor","pointer"),w.selectAll("line").attr("opacity",.05).style("stroke-dasharray","5, 5"),_.call(te);c.selectAll("button").data(l.sort(T.sortAlphaNum)).enter().append("button").attr("class","legend-btn").style("background-color",function(e){return F[i][e]}).style("cursor","pointer").on("click",y).on("mouseover",u).on("mouseout",d).html(function(e){return e})}function a(){var e=v.invert(d3.event.pageX-.02*T.getWidth()),t=b.map(function(e){return e[i]}),a=u(e,t);return a}function u(e,t){for(var a=t[0],r=Math.abs(e-a),o=0;o<t.length;o++){var i=Math.abs(e-t[o]);i<r&&(r=i,a=t[o])}return a}x=T.createChart(d,p),T.setTitle(y,"Impact of changing "+i+" by "+V+(f.AppData[e].Change.indexOf("Default")>=0?" (1 standard deviation) ":"")+" on "+U),x.selectAll("*").remove(),x.attr("width",p);var l=[];o.forEach(function(e){l.indexOf(e.groupByValue)<0&&l.push(e.groupByValue)}),l=l.sort(T.sortAlphaNum);var h=140,s=parseInt(p/h),Y=Math.ceil(l.length/s),I=x.append("g").attr("transform","translate(100,"+(n+30*Y+55)+")");I.append("line").attr("x1",0).attr("y1",0).attr("x2",20).attr("y2",0).attr("stroke","#75787B").attr("stroke-width","3px"),I.append("text").text("Percentile").attr("x",30).attr("y",5);x.attr("height",300+30*Y);var v=d3.scaleLinear().range([r.left,p]),A=d3.scaleLinear().range([n-30,0]),N=d3.area().x(function(e){return v(e.data[i])}).y0(function(e){return A(e[0])}).y1(function(e){return A(e[1])}).curve(d3.curveBasis),D=d3.area().x(function(e){return v(e.data[i])}).y0(function(e){return A(0)}).y1(function(e){return A(0)}).curve(d3.curveBasis),L=x.append("g").attr("class","percRefLines").attr("transform","translate(10,0)"),C=x.append("g").attr("class","textRefLines").attr("transform","translate(10,0)"),_=x.append("g").attr("class","xAxis").attr("transform","translate(10,"+(n+30*Y+20)+")"),w=x.append("g").attr("class","yAxis").attr("transform","translate(60,70)"),k=x.append("g"),W=(x.append("text").attr("class","label").attr("transform","translate("+p/2+","+(n+30*Y+60)+")").style("text-anchor","middle").text(i),x.append("text").attr("class","label").attr("transform","translate(15,"+(n-50)+")rotate(-90)").style("text-anchor","middle").text("Impact on "+U),x.append("line").style("opacity",0).attr("x1",0).attr("y1",30*Y).attr("x2",0).attr("y2",n+30*Y+20).attr("stroke","#75787B"));A.domain([-1,1]);var M=d3.axisLeft().scale(A).tickSizeInner(-p+r.left);w.call(M),t(!1)}function a(){function t(e){var t=[];return e.forEach(function(e){t.indexOf(e[i])<0&&t.push(e[i])}),t}function a(){function t(t,a){E.attr("class","colorClass"+e+a),E.transition().duration(200).delay(100).style("opacity",1),E.html("Within the <span>"+t.key+" </span> group, the model believes that changing <span>"+i+"</span> from <span> "+t.parent+" </span> to <span>"+V+"</span> leads to, on average, a <span>"+Math.abs(T.formatLabel(t.value))+(T.formatLabel(t.value)>=0?" increase":" decrease")+"</span> in "+U).style("left",function(){var e=this.getBoundingClientRect().width,t=d3.event.pageX;return p>e+t+25?d3.event.pageX+5+"px":d3.event.pageX-e-5<10?"10px":d3.event.pageX-e-5+"px"}).style("top",d3.event.pageY-28+"px"),E.style("color",F[i][t]),d3.selectAll(".layer"+e).style("opacity","0.4"),d3.select(this).style("opacity",1).style("stroke","black").attr("stroke-width","1px")}function r(t,a){E.attr("class","colorClass"+e+a),E.transition().duration(200).delay(100).style("opacity",1),E.html("Within the <span>"+t.key+" </span> group, the model believes that changing <span>"+i+"</span> from <span> "+t.parent+" </span> to <span>"+V+"</span> leads to, on average, a <span>"+Math.abs(T.formatLabel(t.value))+(T.formatLabel(t.value)>=0?" increase":" decrease")+"</span> in "+U).style("left",function(){var e=this.getBoundingClientRect().width,t=d3.event.pageX;return p>e+t+25?d3.event.pageX+5+"px":d3.event.pageX-e-5<10?"10px":d3.event.pageX-e-5+"px"}).style("top",d3.event.pageY-28+"px"),E.style("color",F[i][t.key]),d3.selectAll(".layer"+e).style("opacity","0.4"),d3.select(this).style("opacity",1).style("stroke","black").attr("stroke-width","1px")}function n(e,t){E.transition().style("opacity",0),H=!1,D.transition().style("opacity",0),d3.select(this).attr("stroke-width","0px")}function d(e,t){d3.selectAll(".rect"+e.replace(/[^a-zA-Z]/g,"")).style("stroke","black").attr("stroke-width","1px")}function y(e,t){d3.selectAll(".rect"+e.replace(/[^a-zA-Z]/g,"")).style("stroke","black").attr("stroke-width","0px")}function m(e,t){S[i].indexOf(e)>=0?(S[i].splice(S[i].indexOf(e),1),a(!1),d3.select(this).style("opacity",.5).style("background-color","#A7A8AA")):(S[i].push(e),a(!1),d3.select(this).style("opacity",1).style("background-color",F[i][e]))}function s(e,t){e.each(function(){for(var e,a=d3.select(this),r=(a.text()+" → "+V).split(/\s+/).reverse(),o=[],p=0,n=1.1,l=a.attr("y"),d=parseFloat(a.attr("dy")),y=a.text(null).append("tspan").attr("x",0).attr("y",l).attr("dy",d+"em");e=r.pop();)o.push(e),y.text(o.join(" ")),y.node().getComputedTextLength()>t&&(o.pop(),y.text(o.join(" ")),o=[e],y=a.append("tspan").attr("x",0).attr("y",l).attr("dy",++p*n+d+"em").text(e));u=d3.max([430+20*p,u]),d3.select("#topchlvl-"+i.replace(/[^a-zA-Z]/g,"")).style("height",u+"px")})}x=d3.select("#chlvl-"+i.replace(/[^a-zA-Z]/g,"")).select("svg");var f=g.filter(function(e){return S[i].indexOf(e)>=0}),C=0,_=0;b.forEach(function(e){var t=d3.min(f,function(t){return e[t]}),a=d3.max(f,function(t){return e[t]});t<C&&(C=t),a>_&&(_=a)}),C=C>0?.9*C:1.1*C,_=_>0?1.1*_:.9*_;var P=[C>0?0:C,_<0?0-.1*C:_];v.domain(P),Y.domain(l),I.domain(f).rangeRound([0,Y.bandwidth()]);var X=h(o,i,S[i],l);B.html("<ul style='list-style-type:disc' > <li>Across all categories, the impact of <b>"+i+" </b> on <b>"+U+"</b> is lowest for <b> "+X.lowestQuartile+" </b>  "+X.lowestGroup+" and highest for <b> "+X.highestQuartile+" </b> "+X.highestGroup+"</li> <li> The impact of <b>"+i+" </b>  on <b>"+U+"</b> for <b>"+X.highestQuartile+" </b> "+X.highestGroup+" is  "+T.formatLabel(X.diffMaxOverall)+" higher than the overall median impact and "+T.formatLabel(X.diffMaxMin)+" higher than the average impact from <b>"+X.lowestQuartile+"</b> "+X.lowestGroup+"</li>  </ul>");var w=d3.axisBottom().scale(Y);A.transition().duration(1e3).call(L),N.selectAll("g").remove(),N.selectAll("g").data(l).enter().append("g").attr("transform",function(e){return"translate("+Y(e)+",0)"}).selectAll("rect").data(function(e){return f.map(function(t){if(S[i].indexOf(t)>=0){var a={};return a.parent=e,a.key=t,a.value=b.filter(function(t){return t[i]==e})[0][t],a}})}).enter().append("rect").attr("class",function(e){return"rect"+e.key.replace(/[^a-zA-Z]/g,"")}).attr("x",function(e){return I(e.key)}).attr("y",function(e){return v(v(e.value)>=v(0)?0:e.value)}).attr("width",I.bandwidth()).attr("height",function(e){return v(e.value)-v(0)>=0?v(e.value)-v(0):v(0)-v(e.value)}).attr("fill",function(e,t){return F[i][e.key]}).on("mouseover",t).on("mousemove",r).on("mouseout",n).style("cursor","pointer"),A.selectAll("line").attr("opacity",.15).style("stroke-dasharray","4, 4"),x.select(".xAxis").call(w).attr("transform","translate(0,"+(v(0)+70)+")"),x.select(".xAxis").selectAll("text").attr("x",function(e){return 0}).attr("transform","translate(0,"+(v(P[0])-v(0))+")").call(s,.9*Y.bandwidth());c.selectAll("button").data(g).enter().append("button").attr("class","legend-btn").style("background-color",function(e){return F[i][e]}).on("click",m).on("mouseover",d).on("mouseout",y).style("cursor","pointer").html(function(e){return e})}var u=0,l=t(b);x=T.createChart(d,p);var g=[];o.forEach(function(e){g.indexOf(e.groupByValue)<0&&g.push(e.groupByValue)}),T.setTitle(y,"Sensitivity Plot: Impact of changing "+i+" to "+V),g=g.sort(T.sortAlphaNum),x.selectAll("*").remove(),x.attr("width",p);var m=140,s=parseInt(p/m),f=Math.ceil(g.length/s);x.attr("height",300+30*f);var Y=d3.scaleBand().range([r.left,p]).paddingInner(.25),I=d3.scaleBand().padding(.25),v=d3.scaleLinear().range([n,0]);x.append("g").attr("class","xAxis").attr("transform","translate(10,"+(n+30*f+20)+")");var A=x.append("g").attr("class","yAxis").attr("transform","translate(60,70)"),N=x.append("g").attr("transform","translate(0,70)"),D=(x.append("text").attr("class","label").attr("transform","translate("+p/2+","+30*f+")").style("text-anchor","middle").text(i),x.append("text").attr("class","label").attr("transform","translate(15,"+(n-50)+")rotate(-90)").style("text-anchor","middle").text("Impact on "+U),x.append("line").style("opacity",0).attr("x1",0).attr("y1",30*f).attr("x2",0).attr("y2",n+30*f+10).attr("stroke","#75787B"));v.domain([-1,1]);var L=d3.axisLeft().scale(v).tickSizeInner(-p+r.left);A.call(L),a()}var r={top:30,right:15,bottom:60,left:60},o=f.AppData[e].Data.filter(function(e){return e.groupByVarName==w&&k.indexOf(e.groupByValue)<0});if(0==o.length)return null;var i=Object.keys(f.AppData[e].Data[0]).filter(function(e){return _.indexOf(e)<0})[0],p=.74*T.getWidth()-r.left-r.right,n=300-r.top-r.bottom,u=N.append("div").attr("class","chart-lev").attr("id","topchlvl-"+i.replace(/[^a-zA-Z]/g,"")).style("height","430px"),l=u.append("div").attr("class","app").attr("id","chlvl-"+i.replace(/[^a-zA-Z]/g,"")),d=(l.append("div").attr("class","Filtercontainer"),l.append("div").attr("class","Total"),l.append("div").attr("class","Chartcont")),y=d.append("div").attr("class","Title"),c=d.append("div").attr("class","legend").attr("width",p-100).attr("height",n-100),s=u.append("div").attr("class","desc").style("height","560px"),B=s.append("div").attr("class","desc-text").html("Few Insights will come here"),V=(l.append("div").attr("class","Source"),l.append("div").attr("class","Attribution"),""),S={};S[i]=[],o.forEach(function(e){S[i].indexOf(e.groupByValue)<0&&S[i].push(e.groupByValue)});var b=[],Y=d3.nest().key(function(e){return e[i]}).entries(o);Y.forEach(function(t){var a={};a[i]="Continuous"==f.AppData[e].Type?parseFloat(t.key):t.key,S[i].forEach(function(e){var r=t.values.filter(function(t){return t.groupByValue==e});1==r.length?a[e]=r[0].predictedYSmooth:a[e]=null}),b.push(a)});b[0];"Continuous"==f.AppData[e].Type?(console.log(f.AppData[e].Change),V=T.formatLabel(f.AppData[e].Change.indexOf("Default")>=0?f.AppData[e].Change.split(":")[1]:f.AppData[e].Change),t()):"Categorical"==f.AppData[e].Type&&(V=f.AppData[e].Change.indexOf("Default")>=0?f.AppData[e].Change.split(":")[1]:f.AppData[e].Change,a())}var S=a(2),b=r(S),f=a(1);a(6);var T=new b.default,Y=d3.select("#App"),I=(Y.append("div").attr("class","heading").append("a").attr("href","https://github.com/Data4Gov/WhiteBox").html("White Box - Impact By Variable"),Y.append("div").attr("class","summary")),v=I.append("div").attr("class","heatMapContainer"),A=I.append("div").attr("class","filt-cont"),N=Y.append("div").attr("class","Chartcontainer"),E=d3.select("body").append("div").attr("id","tooltip").style("opacity",0);d3.select("body").on("click",function(){H&&(E.style("opacity",0),H=!1)});var D,x,L,C=["#86BC25","#00A3E0","#00ABAB","#C4D600","#2C5234","#9DD4CF","#004F59","#62B5E5","#43B02A","#0076A8","#9DD4CF","#012169"],_=["predictedYSmooth","groupByVarName","groupByValue","highlight","errNeg","errPos"],P=!0,U="Quality",H=!1,X=[10,50,90],F={},w="",k=[],R={};L=T.createChart(v,D),window.togglePercentile=i,window.intializeTreeMap=d,B(),c(),p(),d(f.AppData[0].Data[0].groupByVarName),window.onresize=function(){d3.select(".Chartcontainer").selectAll("*").remove(),D=T.getWidth(),d(f.AppData[0].Data[0].groupByVarName)}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=<***>;t.AppData=a},function(e,t){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),o=function(){function e(){a(this,e)}return r(e,[{key:"setTitle",value:function(e,t){e.selectAll("*").remove();e.append("span").html(t)}},{key:"setLabel",value:function(e,t){e.selectAll("*").remove();e.append("span").html(t)}},{key:"setSource",value:function(e,t){e.selectAll("*").remove(),e.html(t)}},{key:"formatLabel",value:function(e){return e=d3.format(".3f")(e),e=e.replace(/\.0$/,"")}},{key:"createChart",value:function(e,t){var a=e.append("svg");return a.attr("width",t),a}},{key:"getWidth",value:function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth}},{key:"sortDictionary",value:function(e,t){var a=e.name.toLowerCase(),r=t.name.toLowerCase();return a<r?-1:a>r?1:0}},{key:"sortAlphaNum",value:function(e,t){var a=/[^a-zA-Z]/g,r=/[^0-9]/g,o=e.replace(a,""),i=t.replace(a,"");if(o===i){var p=parseInt(e.replace(r,""),10),n=parseInt(t.replace(r,""),10);return p===n?0:p>n?1:-1}return o>i?1:-1}}]),e}();t.default=o},function(e,t,a){t=e.exports=a(4)(),t.push([e.id,'/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}*,:after,:before{box-sizing:border-box;-webkit-tap-highlight-color:transparent}svg{overflow:visible!important}body,html{background-color:#fff;font-family:Open Sans,sans-serif}#App{overflow:hidden;width:100%}.heading{position:fixed;margin-left:1%;width:98%;height:50px;text-align:center;font-size:36px;color:#00a3e0;font-weight:800;box-shadow:2px 2px 4px rgba(0,0,0,.247059);z-index:999;background-color:#fff}.filt-cont{width:24%;height:50px;float:left;margin-top:22px}.dropdown{width:100%;color:#53565a;position:relative;display:inline-block;margin-left:1%;margin-top:10px}.dropdown-content{display:none;position:absolute;background-color:#fff;z-index:1;width:100%;border:1px solid #00a3e0;border-radius:2px;border-top:none;overflow:auto;max-height:300px}.dropdown-content a{color:#53565a;padding:3px 5px;text-decoration:none;display:block;cursor:pointer}.dropdown-content a:hover{background-color:#00a3e0}.dropdown:hover .dropdown-content{display:block}.dropbtn{color:#53565a;background-color:#fff;font-size:14px;border:none;text-align:left;padding-top:3px;padding-bottom:3px;cursor:pointer;width:100%;height:30px;border:1px solid #00a3e0}.drpbtn:focus{outline:none}.heatMapContainer{height:150px;width:74%;margin-left:1%;padding-top:5px;margin-top:10px;float:left}#tooltip{position:absolute;width:auto;text-align:center;border-radius:5px;pointer-events:none;background-color:#fff;padding:8px;z-index:100;font-size:14px;max-width:300px;border:1px solid rgba(0,0,0,.1);box-shadow:4px 4px 6px rgba(0,0,0,.2);z-index:1000}#tooltip span{font-weight:700;font-size:17px}.Title{color:#000;font-size:16px;font-weight:600;padding:12px;text-align:center;text-decoration:underline;width:99%;float:left}.Source{font-weight:300;font-size:14px;padding-left:12px;padding-right:12px;text-align:left}.Source p{margin:2px}svg text{font-size:14px;fill:#53565a;font-weight:400}.app{width:74%;float:left}.Chartcontainer{margin-top:150px;width:100%;float:left}.summary{padding-top:5px;margin-top:2px;height:150px;box-shadow:2px 2px 4px rgba(0,0,0,.247059);position:fixed;width:98%;top:48px;background-color:#fff;margin-left:1%;z-index:1000}.Chartcontainer button{max-width:200px;height:30px;border:none;margin-left:20px;margin-bottom:3px;font-family:Open Sans,sans-serif;font-size:16px;font-weight:600;color:#fff}.Chartcontainer button:focus{outline:0}.tick{font-weight:700}.tick line{opacity:.15}.Chartcontainer button:hover{background-color:#fff;color:#000}.legend{width:90%;margin-left:5%;display:inline-flex;justify-content:center;flex-wrap:wrap;float:left}.legend-btn{width:200px;border:2px solid #53565a!important;border-radius:2px}.label{font-size:12px;font-weight:700}.chart-lev{margin-top:50px;width:98%;box-shadow:2px 2px 4px rgba(0,0,0,.247059);margin-left:1%;display:inline-block}.desc{width:24%;float:left;margin-left:1%}.desc-text{height:320px;width:98%;margin-top:40px;padding:5px;font-size:14px;text-align:justify;overflow-y:auto}.desc-text ul{padding-left:10px}.rect{border:2px solid #53565a}.heading a,.heading a:focus{color:#00a3e0}.perc-check{height:50px;width:98%;margin-left:1%;display:block;position:relative;padding-left:5px;margin-top:12px;cursor:pointer;font-size:16px;color:#53565a;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.perc-check input{cursor:pointer}.perc-checkinput,.perc-check input{position:absolute;opacity:0}.perc-checkinput+label{position:relative;cursor:pointer;padding:0;width:20px;height:20px}.perc-checkinput+label:before{content:"";margin-right:10px;display:inline-block;vertical-align:text-top;width:20px;height:20px;background:#00a3e0;color:#86bc25;border:1px solid #fff;border-radius:2px}.perc-checkinput:hover+label:before{background:#00a3e0;color:#00a3e0}.perc-checkinput:checked+label:before{color:#00a3e0;background:#00a3e0;border:1px solid #fff;border-radius:2px}.perc-checkinput:disabled+label{color:#63666a;cursor:auto}.perc-checkinput:disabled+label:before{box-shadow:none;background:#00a3e0}.perc-checkinput:checked+label:after{content:"";position:absolute;left:4px;top:8px;background:#fff;width:3px;height:3px;box-shadow:2px 0 0 #fff,4px 0 0 #fff,4px -2px 0 #fff,4px -4px 0 #fff,4px -6px 0 #fff,4px -8px 0 #fff;transform:rotate(45deg)}',""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var a=this[t];a[2]?e.push("@media "+a[2]+"{"+a[1]+"}"):e.push(a[1])}return e.join("")},e.i=function(t,a){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<t.length;o++){var p=t[o];"number"==typeof p[0]&&r[p[0]]||(a&&!p[2]?p[2]=a:a&&(p[2]="("+p[2]+") and ("+a+")"),e.push(p))}},e}},function(e,t,a){function r(e,t){for(var a=0;a<e.length;a++){var r=e[a],o=g[r.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](r.parts[i]);for(;i<r.parts.length;i++)o.parts.push(l(r.parts[i],t))}else{for(var p=[],i=0;i<r.parts.length;i++)p.push(l(r.parts[i],t));g[r.id]={id:r.id,refs:1,parts:p}}}}function o(e){for(var t=[],a={},r=0;r<e.length;r++){var o=e[r],i=o[0],p=o[1],n=o[2],u=o[3],l={css:p,media:n,sourceMap:u};a[i]?a[i].parts.push(l):t.push(a[i]={id:i,parts:[l]})}return t}function i(e,t){var a=s(),r=S[S.length-1];if("top"===e.insertAt)r?r.nextSibling?a.insertBefore(t,r.nextSibling):a.appendChild(t):a.insertBefore(t,a.firstChild),S.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");a.appendChild(t)}}function p(e){e.parentNode.removeChild(e);var t=S.indexOf(e);t>=0&&S.splice(t,1)}function n(e){var t=document.createElement("style");return t.type="text/css",i(e,t),t}function u(e){var t=document.createElement("link");return t.rel="stylesheet",i(e,t),t}function l(e,t){var a,r,o;if(t.singleton){var i=V++;a=B||(B=n(t)),r=d.bind(null,a,i,!1),o=d.bind(null,a,i,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(a=u(t),r=c.bind(null,a),o=function(){p(a),a.href&&URL.revokeObjectURL(a.href)}):(a=n(t),r=y.bind(null,a),o=function(){p(a)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}function d(e,t,a,r){var o=a?"":r.css;if(e.styleSheet)e.styleSheet.cssText=b(t,o);else{var i=document.createTextNode(o),p=e.childNodes;p[t]&&e.removeChild(p[t]),p.length?e.insertBefore(i,p[t]):e.appendChild(i)}}function y(e,t){var a=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}function c(e,t){var a=t.css,r=t.sourceMap;r&&(a+="\\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var o=new Blob([a],{type:"text/css"}),i=e.href;e.href=URL.createObjectURL(o),i&&URL.revokeObjectURL(i)}var g={},m=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},h=m(function(){return/msie [6-9]\b/.test(self.navigator.userAgent.toLowerCase())}),s=m(function(){return document.head||document.getElementsByTagName("head")[0]}),B=null,V=0,S=[];e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=h()),"undefined"==typeof t.insertAt&&(t.insertAt="bottom");var a=o(e);return r(a,t),function(e){for(var i=[],p=0;p<a.length;p++){var n=a[p],u=g[n.id];u.refs--,i.push(u)}if(e){var l=o(e);r(l,t)}for(var p=0;p<i.length;p++){var u=i[p];if(0===u.refs){for(var d=0;d<u.parts.length;d++)u.parts[d]();delete g[u.id]}}}};var b=function(){var e=[];return function(t,a){return e[t]=a,e.filter(Boolean).join("\\n")}}()},function(e,t,a){var r=a(3);"string"==typeof r&&(r=[[e.id,r,""]]);a(5)(r,{});r.locals&&(e.exports=r.locals)}]);
