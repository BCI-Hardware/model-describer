!function(e){function r(o){if(i[o])return i[o].exports;var t=i[o]={exports:{},id:o,loaded:!1};return e[o].call(t.exports,t,t.exports,r),t.loaded=!0,t.exports}var i={};return r.m=e,r.c=i,r.p="",r(0)}([function(e,r,i){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function t(e,r){var i=e.data.name;z.indexOf(i)>=0?(z.splice(z.indexOf(i),1),d3.select(this).attr("fill",L.heat[i])):(z.push(i),d3.select(this).attr("fill","#A7A8AA")),T.selectAll("*").remove();for(var o=0;o<S.AppData.length;o++)V(o)}function a(){E=document.getElementById("percentileCheck").checked,d3.select(".Chartcontainer").selectAll("*").remove(),H=P.getWidth(),u(S.AppData[0].Data[0].groupByVarName)}function g(){var e=y(),r=_.append("div").attr("class","dropdown");r.append("button").attr("class","dropbtn").html("<b>Group By:</b> "+C).append("span").style("float","right").html(" ▼");var i=r.append("div").attr("class","dropdown-content");i.selectAll("a").data(e).enter().append("a").html(function(e){return e}).attr("onclick",function(e){return"intializeTreeMap('"+e+"')"});_.append("div").attr("class","perc-check").html("<input id='percentileCheck' class='perc-checkinput' checked='true' onchange='togglePercentile()' type='checkbox'><label for='percentileCheck'>Percentiles</label>")}function h(e,r){setTimeout(function(){R=!0},300);var i=M.statData.filter(function(r){return r.groupByVarName==C&&r.groupByValue==e.data.name})[0],o=M.proportion.filter(function(r){return r.name==e.data.name})[0];W.style("opacity",1).style("left",d3.event.pageX+"px").style("top",d3.event.pageY+"px").style("color",L.heat[e]).html("Group <b>"+i.groupByValue+" </b> is "+o.perc+"% of the data and has an average error of <b>"+P.formatLabel(i.MSE)+"</b>")}function l(e,r){setTimeout(function(){R=!0},300);var i=M.statData.filter(function(r){return r.groupByVarName==C&&r.groupByValue==e.data.name})[0],o=M.proportion.filter(function(r){return r.name==e.data.name})[0];W.style("opacity",1).style("left",d3.event.pageX+"px").style("top",d3.event.pageY+"px").style("color",L.heat[e.data.name]).html("Group <b>"+i.groupByValue+" </b> is "+P.formatLabel(o.perc)+"% of the data and has an average error of <b>"+P.formatLabel(i.MSE)+"</b>")}function d(e,r){W.style("opacity",0)}function u(e){function r(e){return e.children?0:1}function i(e){return e.size}L.heat={},C=e,m(),d3.select(".dropbtn").html("<b>Group By:</b> "+C).append("span").style("float","right").html(" ▼");var o=p(C),a={top:50,right:15,bottom:30,left:60};w.selectAll("*").remove();var g=.8*P.getWidth()-.1*a.left-a.right-.1*P.getWidth(),u=200-a.top-a.bottom;w.attr("width",g),w.attr("height",u);var y=function(e){return d3.interpolateRgb(e,"#fff")(.2)},N=(d3.scaleOrdinal(d3.schemeCategory20.map(y)),d3.format(",d"),d3.treemap().tile(d3.treemapResquarify).size([g,u-20]).round(!0).paddingInner(2)),c=d3.hierarchy(o).eachBefore(function(e){e.data.id=(e.parent?e.parent.data.id+".":"")+e.data.name}).sum(i).sort(function(e,r){return r.data.name-e.data.name});N(c),M.proportion=c.data.children;var s=0;for(var B in M.proportion)s+=M.proportion[B].size;for(var B in M.proportion)M.proportion[B].perc=100*M.proportion[B].size/s;var n=w.append("g").attr("class","cell-group").attr("transform","translate(0,20)"),b=n.selectAll("g").data(c.leaves()).enter().append("g").attr("transform",function(e){return"translate("+e.x0+","+e.y0+")"});b.append("rect").attr("id",function(e){return e.data.id+" brdr"}).attr("x",-2).attr("y",-2).attr("class","borderpath").attr("width",function(e){return e.x1-e.x0+4}).attr("height",function(e){return e.y1-e.y0+4}).attr("fill",function(e){return"#53565A"}).style("cursor","pointer"),b.append("rect").attr("id",function(e){return e.data.id}).attr("class","rect").attr("width",function(e){return e.x1-e.x0}).attr("height",function(e){return e.y1-e.y0}).attr("fill",function(e){return L.heat[e.data.name]}).on("click",t).on("mouseenter",h).on("mouseout",d).on("mousemove",l).style("cursor","pointer"),b.append("text").attr("clip-path",function(e){return"url(#clip-"+e.data.id+")"}).attr("dx",10).attr("dy",20).text(function(e){if(e.x1-e.x0>100){var r=M.statData.filter(function(r){return r.groupByVarName==C&&r.groupByValue==e.data.name})[0],i=M.proportion.filter(function(r){return r.name==e.data.name})[0];return"Category: "+r.groupByValue+" ("+P.formatLabel(i.perc)+"%)"}return""}).style("fill","#fff"),b.append("text").attr("clip-path",function(e){return"url(#clip-"+e.data.id+")"}).attr("dx",10).attr("dy",40).text(function(e){if(e.x1-e.x0>100){var r=M.statData.filter(function(r){return r.groupByVarName==C&&r.groupByValue==e.data.name})[0];return"Average Error: "+P.formatLabel(r.MSE)}return""}).style("fill","#fff"),d3.selectAll("input").data([i,r],function(e){return e?e.name:this.value}),T.selectAll("*").remove();for(var Y=0;Y<S.AppData.length;Y++)V(Y)}function p(e){var r={name:"heatMap",children:[]},i=S.AppData[0].Data,o=i.filter(function(r){return r.groupByVarName==e}),t=M.statData.filter(function(r){return r.groupByVarName==e}),a=d3.nest().key(function(e){return e.groupByValue}).rollup(function(e){return e.length}).entries(o);return a.forEach(function(e){var i={};i.name=e.key,i.size=t.filter(function(r){return r.groupByValue==e.key})[0].Total,r.children.push(i)}),r.children=r.children.sort(P.sortDictionary),r}function y(){var e=[];return S.AppData.forEach(function(r){r.Data.forEach(function(r){e.indexOf(r.groupByVarName)<0&&e.push(r.groupByVarName)})}),e}function N(e,r,i,o){var t=e.filter(function(e){return e.groupByValue==i});if(100==r){var a=t[t.length-1][o];return P.formatLabel(a)}var g=r/100*(t.length+1),h=parseInt(g);if(h)var a=t[h-1][o];else var a=t[h][o];return P.formatLabel(a)}function c(e,r,i){var o=d3.extent(e.map(function(e){return e[r]})),t={},a={};a.overEst="",a.underEst="",t.quartiles=[];for(var g=(d3.quantile(o,.25)-d3.min(o),1);g<=4;g++)for(var h in i){var l=i[h],d={};d.quarter=g,d.group=l;var u=N(e,25*(g-1),l,r),p=N(e,25*g,l,r);d.range=[u,p];var y=e.filter(function(e){return e[r]>=u&&e[r]<=p&&e.groupByValue==l});d.averageImpact=d3.mean(y.map(function(e){return e.predictedYSmooth})),d.medianImpact=d3.median(y.map(function(e){return e.predictedYSmooth})),d.estimate=Math.abs(d3.mean(y.map(function(e){return e.predictedYSmooth}))/d3.mean(y.map(function(e){return e.predictedYSmooth}))),d.estimate>=1?a.overEst+=P.formatLabel(u)+"-"+P.formatLabel(p)+", ":a.underEst+=P.formatLabel(u)+"-"+P.formatLabel(p)+", ",t.quartiles.push(d)}return a.lowest=d3.min(t.quartiles.map(function(e){return e.averageImpact})),a.highest=d3.max(t.quartiles.map(function(e){return e.averageImpact})),a.lowestGroup=t.quartiles.filter(function(e){return e.averageImpact==a.lowest})[0].group,a.lowestGroup=a.lowestGroup.indexOf("Bin")>=0?"for group "+a.lowestGroup.split("_")[1]:" for "+a.lowestGroup,a.highestGroup=t.quartiles.filter(function(e){return e.averageImpact==a.highest})[0].group,a.highestGroup=a.highestGroup.indexOf("Bin")>=0?"for group "+a.highestGroup.split("_")[1]:" for "+a.highestGroup,a.lowestQuartile=t.quartiles.filter(function(e){return e.averageImpact==a.lowest})[0].range,a.highestQuartile=t.quartiles.filter(function(e){return e.averageImpact==a.highest})[0].range,a.lowestRange=a.lowestQuartile,a.highestRange=a.highestQuartile,a.overAllAverageImpact=d3.mean(e.map(function(e){return e.predictedYSmooth})),a.overAllMedianImpact=d3.median(e.map(function(e){return e.predictedYSmooth})),a.diffMaxOverall=a.highest-a.overAllMedianImpact,a.diffMaxMin=a.highest-a.lowest,a}function s(e,r,i,o){var t=d3.extent(e.map(function(e){return e[r]})),a={},g={};g.overEst="",g.underEst="",a.quartiles=[];var h=d3.quantile(t,.25)-d3.min(t);for(var l in o)for(var d in i){var u=i[d],p=o[l],y={};y.quarter=p,y.group=u;var N=(d3.min(t)+(l-1)*h,d3.min(t)+l*h,e.filter(function(e){return e[r]==p&&e.groupByValue==u}));y.averageError=d3.mean(N.map(function(e){return e.errPos+e.errNeg})),y.MedianError=d3.median(N.map(function(e){return e.errPos+e.errNeg})),y.estimate=Math.abs(d3.mean(N.map(function(e){return e.errPos}))/d3.mean(N.map(function(e){return e.errNeg}))),y.estimate>=1?g.overEst+=p+" for "+u+", ":g.underEst+=p+" for "+u+", ",a.quartiles.push(y)}return g.lowest=d3.min(a.quartiles.map(function(e){return e.averageError})),g.highest=d3.max(a.quartiles.map(function(e){return e.averageError})),g.lowestGroup=a.quartiles.filter(function(e){return e.averageError==g.lowest})[0].group,g.lowestGroup=g.lowestGroup.indexOf("Bin")>=0?"for group "+g.lowestGroup.split("_")[1]:" for "+g.lowestGroup,g.highestGroup=a.quartiles.filter(function(e){return e.averageError==g.highest})[0].group,g.highestGroup=g.highestGroup.indexOf("Bin")>=0?"for group "+g.highestGroup.split("_")[1]:" for "+g.highestGroup,g.lowestQuartile=a.quartiles.filter(function(e){return e.averageError==g.lowest})[0].quarter,g.highestQuartile=a.quartiles.filter(function(e){return e.averageError==g.highest})[0].quarter,g.overAllAverageError=d3.mean(e.map(function(e){return e.errPos+e.errNeg})),g.overAllMedianError=d3.median(e.map(function(e){return e.errPos+e.errNeg})),g.diffMaxOverall=g.highest-g.overAllMedianError,g.diffMaxMin=g.highest-g.lowest,g}function m(){for(var e=[],r=0;r<S.AppData.length;r++){var i=S.AppData[r].Data.filter(function(e){return e.groupByVarName==C});if(i.length>0){var o=i[0],t=Object.keys(o).filter(function(e){return k.indexOf(e)<0})[0];L[t]={},L.heat={},i.forEach(function(r){e.indexOf(r.groupByValue)<0&&e.push(r.groupByValue)}),e.sort(P.sortAlphaNum),e.forEach(function(e,r){L[t][e]=x[r]})}}e.forEach(function(e,r){L.heat[e]=x[r]})}function B(){S.AppData.filter(function(e,r){"Accuracy"==e.Type&&(M.statData=e.Data,S.AppData.splice(r,1))})}function V(e){function r(){function r(t){function g(e,r){var i=d3.select("#"+a.replace(/[^a-zA-Z]/g,""));i.selectAll(".errorline").style("opacity",.25),i.selectAll("."+e).style("opacity",1)}function u(e,r){var i=d3.select("#"+a.replace(/[^a-zA-Z]/g,""));i.selectAll(".errorline").style("opacity",1),i.selectAll(".posError").style("opacity",.4),i.selectAll(".negError").style("opacity",.4),i.selectAll(".circleH").style("opacity",.4)}function p(r,t){var g=d3.select("#"+a.replace(/[^a-zA-Z]/g,"")),l=d3.select(this).attr("class").split(" ")[2],d=i();X.transition().style("opacity",1).attr("x1",S(d)).attr("x2",S(d)).attr("transform","translate(10,0)"),setTimeout(function(){R=!0},300);var u=o.filter(function(e){return e[a]==d&&e.groupByValue==l})[0];W.attr("class","colorClass"+e+t),W.transition().duration(200).delay(100).style("opacity",1),W.html("At <span>"+P.formatLabel(u[a])+", "+a+" </span>has a Predicted-Quality of <span>"+P.formatLabel(u.predictedYSmooth)+" </span> with a positive error of <span>"+("null"!=u.errPos?P.formatLabel(u.errPos):0)+"</span> and a negative error of <span> "+("null"!=u.errNeg?P.formatLabel(u.errNeg):0)+"</span>").style("left",function(){var e=this.getBoundingClientRect().width,r=d3.event.pageX;return h>e+r+25?d3.event.pageX+5+"px":d3.event.pageX-e-5<10?"10px":d3.event.pageX-e-5+"px"}).style("top",d3.event.pageY+20+"px"),W.style("color",L[a][u.groupByValue]),g.selectAll(".errorline").style("opacity",.1),g.selectAll("circle").style("opacity",.1),g.selectAll("."+l).style("opacity",1).attr("cursor","pointer"),g.selectAll(".circleH").filter("."+l).style("opacity",.4)}function y(e){var r=d3.select("#"+a.replace(/[^a-zA-Z]/g,""));d3.select(this).attr("class").split(" ")[1];r.selectAll("path").style("opacity",1),r.selectAll(".negError").style("opacity",.25),r.selectAll(".posError").style("opacity",.25),r.selectAll("circle").style("opacity",1),r.selectAll(".circleH").style("opacity",.4),W.transition().duration(200).delay(100).style("opacity",0),X.transition().style("opacity",0)}function s(r,t){var g=d3.select("#"+a.replace(/[^a-zA-Z]/g,"")),l=d3.select(this).attr("class").split(" ")[2],d=i();X.transition().style("opacity",1).attr("x1",S(d)).attr("x2",S(d)).attr("transform","translate(10,0)"),setTimeout(function(){R=!0},300);var u=o.filter(function(e){return e[a]==d&&e.groupByValue==l})[0];W.attr("class","colorClass"+e+t),W.transition().duration(200).delay(100).style("opacity",1),W.html("At <span>"+P.formatLabel(u[a])+", "+a+" </span>has a Predicted-Quality of <span>"+P.formatLabel(u.predictedYSmooth)+" </span> with a positive error of <span>"+("null"!=u.errPos?P.formatLabel(u.errPos):0)+"</span> and a negative error of <span> "+("null"!=u.errNeg?P.formatLabel(u.errNeg):0)+"</span>").style("left",function(){var e=this.getBoundingClientRect().width,r=d3.event.pageX;return h>e+r+25?d3.event.pageX+5+"px":d3.event.pageX-e-5<10?"10px":d3.event.pageX-e-5+"px"}).style("top",d3.event.pageY+20+"px"),W.style("color",L[a][u.groupByValue]),g.selectAll(".errorline").style("opacity",.1),g.selectAll("circle").style("opacity",.1),g.selectAll("."+l).style("opacity",1).attr("cursor","pointer"),g.selectAll(".circleH").filter("."+l).style("opacity",.4)}function b(e,i){n[a].indexOf(e)>=0?(n[a].splice(n[a].indexOf(e),1),r(!1),d3.select(this).style("opacity",.5).style("background-color","#A7A8AA")):(n[a].push(e),r(!1),d3.select(this).style("opacity",1).style("background-color",L[a][e]))}k.selectAll("*").remove(),z.selectAll("*").remove(),O.selectAll("*").remove(),I.selectAll("*").remove(),q.selectAll("*").remove(),console.log(o);var A=c(o,a,n[a]);V.html("<ul style='list-style-type:disc' > <li>Across all categories, the model's error in predicting <b>"+G+" </b> is lowest from <b> ["+A.lowestRange+"] </b> "+A.lowestGroup+" and highest from <b> ["+A.highestRange+"] </b> "+A.highestGroup+"</li> <li> The error from <b> ["+A.highestRange+"] </b>"+A.highestGroup+" is  "+P.formatLabel(A.diffMaxOverall)+" higher than the overall median error and "+P.formatLabel(A.diffMaxMin)+" higher than the average error from <b> ["+A.lowestRange+"] </b> "+A.lowestGroup+"</li> <li> When the model makes prediction errors, there are times when those errors systematically lean in one direction </li><li>  The model tends to consistently make mistakes in the same direction when it miss-estimates "+a+" between "+A.overEst.slice(0,A.overEst.length-2)+" (overestimate) and "+A.underEst.slice(0,A.underEst.length-2)+" (underestimate) </li></ul>");var C=n[a],U=100,Z=0,F=o.filter(function(e){return C.indexOf(e.groupByValue)>=0});S.domain(d3.extent(F,function(e){return e[a]})),F.forEach(function(e){var r=e.predictedYSmooth+("null"==e.errPos?0:Math.abs(e.errPos)),i=e.predictedYSmooth+("null"==e.errNeg?0:e.errNeg);U>i&&(U=i),Z<r&&(Z=r)});var J=[];for(var $ in D){var K=0,ee=0;for(var re in n[a]){var ie=n[a][re],oe=N(o,D[$],ie,a),te=M.proportion.filter(function(e){return e.name==ie})[0].perc/100;K+=oe*te,ee+=te}J.push({percentile:D[$],value:P.formatLabel(K/ee)})}if(F=F.sort(function(e,r){return e[a]-r[a]}),Y.domain([U,Z]),w.transition().duration(1e3).call(j),E){var ae=T.selectAll("line").data(J);ae.exit().remove(),ae.enter().append("line").style("opacity",1).attr("x1",function(e){return S(e.value)}).attr("y1",30*B).attr("x2",function(e){return S(e.value)}).attr("y2",l+30*B+10).attr("stroke","#75787B").attr("stroke-width","2px"),ae.transition().attr("x1",function(e){return S(e.value)}).attr("y1",30*B).attr("x2",function(e){return S(e.value)}).attr("y2",l+30*B+10).attr("stroke","#75787B").attr("stroke-width","2px");var ge=x.selectAll("text").data(J);ge.exit().remove(),ge.enter().append("text").text(function(e){return e.percentile}).attr("transform",function(e){return"translate("+(S(e.value)-5)+",25)"}),ge.transition().text(function(e){return e.percentile}).attr("transform",function(e){return"translate("+(S(e.value)-5)+",25)"})}O.selectAll("path").data(C).enter().append("path").attr("fill","none").attr("class",function(e){return"errorline "+e}).attr("stroke",function(e){return L[a][e]}).attr("stroke-width","2px").datum(function(e){var r=[];return F.map(function(i){i.groupByValue==e&&r.push(i)}),r}).attr("d",v),k.selectAll("path").data(C).enter().append("path").attr("class",function(e){return"errorline posError "+e}).attr("fill","grey").style("opacity",.4).datum(function(e){var r=[];return F.map(function(i){i.groupByValue==e&&r.push(i)}),r}).attr("id","line"+a.replace(/[^a-zA-Z]/g,"")).attr("d",f),z.selectAll("path").data(C).enter().append("path").attr("fill","grey").attr("class",function(e){return"errorline negError "+e}).style("opacity",.4).datum(function(e){var r=[];return F.map(function(i){i.groupByValue==e&&r.push(i)}),r}).attr("id","line"+a.replace(/[^a-zA-Z]/g,"")).attr("d",_);d3.select("#"+a.replace(/[^a-zA-Z]/g,"")).selectAll(".errorline").on("mouseenter",s).on("mouseout",y).on("mousemove",p),H.transition().duration(1e3).call(Q),H.selectAll("line").attr("opacity",.25).style("stroke-dasharray","3, 3"),w.selectAll("line").attr("opacity",.25).style("stroke-dasharray","3, 3");m.selectAll("button").data(d.sort(P.sortAlphaNum)).enter().append("button").attr("class",function(e){return"legend-btn "+e}).style("background-color",function(e){return L[a][e]}).style("cursor","pointer").on("click",b).on("mouseover",g).on("mouseout",u).html(function(e){return e})}function i(){var e=S.invert(d3.event.pageX-.02*P.getWidth()),r=o.map(function(e){return e[a]}),i=t(e,r);return i}function t(e,r){for(var i=r[0],o=Math.abs(e-i),t=0;t<r.length;t++){var a=Math.abs(e-r[t]);a<o&&(o=a,i=r[t])}return i}A=P.createChart(y,h),P.setTitle(u,"Error Distribution Graph: "+a+" (Grouped by "+C+")"),A.selectAll("*").remove(),A.attr("width",h);var d=[];o.forEach(function(e){d.indexOf(e.groupByValue)<0&&(d.push(e.groupByValue),n[a].push(e.groupByValue))});var p=140,s=parseInt(h/p),B=Math.ceil(d.length/s),b=A.append("g").attr("transform","translate(100,"+(l+30*B+35)+")");b.append("line").attr("x1",0).attr("y1",0).attr("x2",20).attr("y2",0).attr("stroke","#75787B").attr("stroke-width","3px"),b.append("text").text("Percentile").attr("x",30).attr("y",5);A.attr("height",l+30*B);var S=d3.scaleLinear().range([g.left,h]),Y=d3.scaleLinear().range([l,0]),v=(d3.interpolateCool,d3.line().x(function(e){return S(e[a])}).y(function(e){return Y(e.predictedYSmooth)}).curve(d3.curveBasis)),f=d3.area().x(function(e){return S(e[a])}).y0(function(e){return Y(e.predictedYSmooth)}).y1(function(e){return Y(e.predictedYSmooth+("null"==e.errPos?0:e.errPos))}).curve(d3.curveBasis),_=d3.area().x(function(e){return S(e[a])}).y0(function(e){return Y(e.predictedYSmooth+("null"==e.errNeg?0:e.errNeg))}).y1(function(e){return Y(e.predictedYSmooth)}).curve(d3.curveBasis),T=A.append("g").attr("class","percRefLines").attr("transform","translate(10,0)"),x=A.append("g").attr("class","textRefLines").attr("transform","translate(10,0)"),H=A.append("g").attr("class","xAxis Axes").attr("transform","translate(10,"+(l+30*B+10)+")"),w=A.append("g").attr("class","yAxis Axes").attr("transform","translate(60,30)"),k=A.append("g").attr("class","posErrorG").attr("transform","translate(10,"+30*B+")"),z=A.append("g").attr("class","negErrorG").attr("transform","translate(10,"+30*B+")"),O=A.append("g").attr("class","lineG").attr("transform","translate(10,"+30*B+")"),I=A.append("g").attr("class","circleG").attr("transform","translate(10,"+30*B+")"),q=A.append("g").attr("class","circleHG").attr("transform","translate(10,"+30*B+")"),X=(A.append("text").attr("class","label").attr("transform","translate("+h/2+","+(l+30*B+40)+")").style("text-anchor","middle").text(a),A.append("text").attr("class","label").attr("transform","translate(15,"+l/2+")rotate(-90)").style("text-anchor","end").text("Predicted-Quality"),A.append("line").style("opacity",0).attr("x1",0).attr("y1",30*B-10).attr("x2",0).attr("y2",l+30*B+10).attr("stroke","#75787B"));Y.domain([-1,1]);var j=d3.axisLeft().scale(Y).tickSizeInner(-h+g.left),Q=d3.axisBottom().scale(S).tickSizeInner(-l-10);w.call(j),H.call(Q),r(!1)}function i(){function e(e){var r=[];return e.forEach(function(e){r.indexOf(e[a])<0&&r.push(e[a])}),r}function r(){function e(e,r){W.transition().duration(200).delay(100).style("opacity",1),W.html("<span>"+a+"</span> has a Predicted-Quality of <span>"+P.formatLabel(e.predictedYSmooth)+"</span> for category <span>"+e.groupByValue+"</span> with errors in ranging, on average, from <span>"+P.formatLabel(e.errNeg)+"</span> to <span>"+P.formatLabel(e.errPos)+"</span>").style("left",function(){var e=this.getBoundingClientRect().width,r=d3.event.pageX;return h>e+r+25?d3.event.pageX+5+"px":d3.event.pageX-e-5<10?"10px":d3.event.pageX-e-5+"px"}).style("top",d3.event.pageY+15+"px"),W.style("color",L[a][e.groupByValue])}function g(e,r){W.transition().duration(200).delay(100).style("opacity",1),W.html("<span>"+a+"</span> has a Predicted-Quality of <span>"+P.formatLabel(e.predictedYSmooth)+"</span> for category <span>"+e.groupByValue+"</span> with errors in ranging, on average, from <span>"+P.formatLabel(e.errNeg)+"</span> to <span>"+P.formatLabel(e.errPos)+"</span>").style("left",function(){var e=this.getBoundingClientRect().width,r=d3.event.pageX;return h>e+r+25?d3.event.pageX+5+"px":d3.event.pageX-e-5<10?"10px":d3.event.pageX-e-5+"px"}).style("top",d3.event.pageY+15+"px"),W.style("color",L[a][e.groupByValue])}function d(e,r){var i=d3.select("#"+a.replace(/[^a-zA-Z]/g,""));i.selectAll("."+e).style("stroke","#000").style("stroke-width",2)}function u(e,r){var i=d3.select("#"+a.replace(/[^a-zA-Z]/g,""));i.selectAll("."+e).style("stroke-width",0)}function p(e,r){W.transition().style("opacity",0),R=!1,v.transition().style("opacity",0),d3.select(this).attr("stroke-width","0px")}function y(e,i){n[a].indexOf(e)>=0?(n[a].splice(n[a].indexOf(e),1),r(),d3.select(this).style("opacity",.5).style("background-color","#A7A8AA")):(n[a].push(e),r(),d3.select(this).style("opacity",1).style("background-color",L[a][e]))}Y.selectAll("*").remove(),_.selectAll("*").remove();var N=_.append("g").attr("class","posLineGroup").attr("transform","translate(0,70)"),T=_.append("g").attr("class","dashedLineGroup").attr("transform","translate(0,70)"),x=_.append("g").attr("class","circleGroup").attr("transform","translate(0,70)"),H=_.append("g").attr("class","negLineGroup").attr("transform","translate(0,70)"),w=n[a].sort(P.sortAlphaNum),k=1e3,E=0,C=o.filter(function(e){return w.indexOf(e.groupByValue)>=0});C.forEach(function(e){var r=Math.abs(e.predictedYSmooth)+Math.abs(e.errPos),i=Math.abs(e.predictedYSmooth)-Math.abs(e.errNeg);k=d3.min([k,r,i]),E=d3.max([E,r,i])});var z=[k>0?.9*k:1.1*k,E<0?.9*E:1.1*E];c.domain(i),B.domain(w).rangeRound([0,c.bandwidth()]),b.domain(z);var M=s(C,a,n[a],i);V.html("<ul style='list-style-type:disc' > <li>Across all categories, the model's error in predicting <b>"+G+" </b> is lowest for <b> "+M.lowestQuartile+" </b> "+M.lowestGroup+" and highest for <b> "+M.highestQuartile+" </b> "+M.highestGroup+"</li> <li> The error for <b>"+M.highestQuartile+" </b> "+M.highestGroup+" is  "+P.formatLabel(M.diffMaxOverall)+" higher than the overall median error and "+P.formatLabel(M.diffMaxMin)+" higher than the average error from <b>"+M.lowestQuartile+"</b> "+M.lowestGroup+"</li> <li> When the model makes prediction errors, there are times when those errors systematically lean in one direction </li><li>  The model tends to consistently make mistakes in the same direction when it miss-estimates "+a+" between "+M.overEst.slice(0,M.overEst.length-2)+" (overestimate) and "+M.underEst.slice(0,M.underEst.length-2)+" (underestimate) </li></ul>");var D=d3.axisBottom().scale(c);S.transition().duration(1e3).call(f),A.select(".xAxis").call(D).attr("transform","translate(0,"+(l+50)+")");T.selectAll("g").data(i).enter().append("g").selectAll("line").data(function(e){return C.filter(function(r){return r[a]==e})}).enter().append("line").attr("x1",function(e){return c(e[a])+B(e.groupByValue)+B.bandwidth()/2}).attr("y1",function(e){return b(e.predictedYSmooth+e.errNeg)}).attr("x2",function(e){return c(e[a])+B(e.groupByValue)+B.bandwidth()/2}).attr("y2",function(e){return b(e.predictedYSmooth+e.errPos)}).attr("stroke-width",2).style("stroke-dasharray","4, 4").attr("opacity",1).attr("stroke","#75787B"),x.selectAll("g").data(i).enter().append("g").attr("class",function(e){return"circleGroup "+e}).selectAll("circle").data(function(e){return C.filter(function(r){return r[a]==e})}).enter().append("circle").attr("class",function(e){return"circle "+e.groupByValue}).attr("r",5).attr("cx",function(e){return c(e[a])+B(e.groupByValue)+B.bandwidth()/2}).attr("cy",function(e){return b(e.predictedYSmooth)}).attr("fill",function(e){return L[a][e.groupByValue]}),N.selectAll("g").data(i).enter().append("g").selectAll("rect").data(function(e){return C.filter(function(r){return r[a]==e})}).enter().append("rect").attr("x",function(e){return c(e[a])+B(e.groupByValue)+B.bandwidth()/4}).attr("y",function(e){return b(e.predictedYSmooth+e.errPos)}).attr("width",function(e){return B.bandwidth()/2}).attr("height",function(e){return 1}).attr("stroke-width",3).attr("opacity",1).attr("fill","#75787B"),H.selectAll("g").data(i).enter().append("g").selectAll("rect").data(function(e){return C.filter(function(r){return r[a]==e&&n[a].indexOf(r.groupByValue)>=0})}).enter().append("rect").attr("x",function(e){return c(e[a])+B(e.groupByValue)+B.bandwidth()/4}).attr("y",function(e){return b(e.predictedYSmooth+e.errNeg)}).attr("width",function(e){return B.bandwidth()/2}).attr("height",function(e){return 1}).attr("stroke-width",3).attr("opacity",1).attr("fill","#75787B");A.selectAll("circle").on("mouseenter",e).on("mouseout",p).on("mousemove",g).attr("cursor","pointer"),A.select(".xAxis").selectAll("line").attr("opacity",.15).style("stroke-dasharray","4, 4"),A.select(".yAxis").selectAll("line").attr("opacity",.15).style("stroke-dasharray","4, 4"),A.select(".xAxis").selectAll("text").attr("x",function(e){return 0});m.selectAll("button").data(t.sort(P.sortAlphaNum)).enter().append("button").attr("class","legend-btn").style("background-color",function(e){return L[a][e]}).style("cursor","pointer").on("click",y).on("mouseover",d).on("mouseout",u).html(function(e){return e})}var i=e(o);A=P.createChart(y,h),P.setTitle(u,"Error Distribution Graph: "+a+" (Grouped by Type) "),A.selectAll("*").remove(),A.attr("width",h);var t=[];o.forEach(function(e){t.indexOf(e.groupByValue)<0&&(t.push(e.groupByValue),n[a].push(e.groupByValue))});var d=140,p=parseInt(h/d),N=Math.ceil(t.length/p);A.attr("height",450+30*N);var c=(d3.stack(),d3.scaleBand().range([g.left,h]).paddingInner(.25)),B=d3.scaleBand().padding(.25),b=d3.scaleLinear().range([l-30,0]);A.append("g").attr("class","xAxis").attr("transform","translate(10,"+(l+30*N+20)+")");var S=A.append("g").attr("class","yAxis").attr("transform","translate(60,70)"),Y=A.append("g").attr("transform","translate(0,70)"),v=(A.append("text").attr("class","label").attr("transform","translate("+h/2+","+(l+30*N+60)+")").style("text-anchor","middle").text(a),A.append("text").attr("class","label").attr("transform","translate(15,"+l/2+")rotate(-90)").style("text-anchor","end").text("Predicted-Quality"),A.append("line").style("opacity",0).attr("x1",0).attr("y1",30*N+20).attr("x2",0).attr("y2",l+30*N).attr("stroke","#75787B"));b.domain([-10,10]);var f=d3.axisLeft().scale(b).tickSizeInner(-h+g.left);S.call(f);var _=A.append("g");r()}var o=S.AppData[e].Data.filter(function(e){return e.groupByVarName==C&&z.indexOf(e.groupByValue)<0});if(0==o.length)return null;var t=o[0],a=Object.keys(t).filter(function(e){return k.indexOf(e)<0})[0],g={top:20,right:15,bottom:30,left:60},h=.74*P.getWidth()-g.left-g.right,l=300-g.top-g.bottom,d=T.append("div").attr("class","chart-lev").attr("id","chlvl-"+a.replace(/[^a-zA-Z]/g,"")).style("height","430px"),u=d.append("div").attr("class","Title"),p=d.append("div").attr("class","app").attr("id",a.replace(/[^a-zA-Z]/g,"")),y=(p.append("div").attr("class","Filtercontainer"),p.append("div").attr("class","Total"),p.append("div").attr("class","Chartcont")),u=y.append("div").attr("class","Title"),m=y.append("div").attr("class","legend").attr("width",h-100).attr("height",l-100),B=d.append("div").attr("class","desc").style("height","560px"),V=B.append("div").attr("class","desc-text"),n=(p.append("div").attr("class","Source"),p.append("div").attr("class","Attribution"),{});n[a]=[],"Continuous"==S.AppData[e].Type?r():"Categorical"==S.AppData[e].Type&&i()}var n=i(2),b=o(n),S=i(1);i(6);var P=new b.default,Y=d3.select("#App"),v=(Y.append("div").attr("class","heading").append("a").attr("href","https://github.com/Data4Gov/WhiteBox").html("White Box - Prediction Error By Variable"),Y.append("div").attr("class","summary")),f=v.append("div").attr("class","heatMapContainer"),_=v.append("div").attr("class","filt-cont"),T=Y.append("div").attr("class","Chartcontainer"),x=["#86BC25","#00A3E0","#00ABAB","#C4D600","#2C5234","#9DD4CF","#004F59","#62B5E5","#43B02A","#0076A8","#9DD4CF","#012169"],R=!1,W=d3.select("body").append("div").attr("id","tooltip").style("opacity",0);d3.select("body").on("click",function(){R&&(W.style("opacity",0),R=!1)}),console.log(S.AppData);var H,A,w,k=["predictedYSmooth","groupByVarName","groupByValue","highlight","errNeg","errPos"],E=!0,L={},C="",z=[],M={};w=P.createChart(f,H);var G="Quality",D=[10,50,90];window.togglePercentile=a,window.intializeTreeMap=u,B(),y(),g(),u(S.AppData[0].Data[0].groupByVarName),window.onresize=function(){d3.select(".Chartcontainer").selectAll("*").remove(),H=P.getWidth(),u(S.AppData[0].Data[0].groupByVarName);for(var e=0;e<S.AppData.length;e++)V(e)}},function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=<***>;r.AppData=i},function(e,r){"use strict";function i(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,r){for(var i=0;i<r.length;i++){var o=r[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(r,i,o){return i&&e(r.prototype,i),o&&e(r,o),r}}(),t=function(){function e(){i(this,e)}return o(e,[{key:"setTitle",value:function(e,r){e.selectAll("*").remove();e.append("span").html(r)}},{key:"setLabel",value:function(e,r){e.selectAll("*").remove();e.append("span").html(r)}},{key:"setSource",value:function(e,r){e.selectAll("*").remove(),e.html(r)}},{key:"setAttribution",value:function(e){e.append("p").text("Deloitte University Press | dupress.deloitte.com")}},{key:"createChart",value:function(e,r){var i=e.append("svg");return i.attr("width",r),i}},{key:"buildLegenedGroup",value:function(){}},{key:"formatLabel",value:function(e){return e=parseFloat(e),e=d3.format(".3f")(e),e=e.replace(/\.0$/,"")}},{key:"getWidth",value:function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth}},{key:"sortAlphaNum",value:function(e,r){var i=/[^a-zA-Z]/g,o=/[^0-9]/g,t=e.replace(i,""),a=r.replace(i,"");if(t===a){var g=parseInt(e.replace(o,""),10),h=parseInt(r.replace(o,""),10);return g===h?0:g>h?1:-1}return t>a?1:-1}},{key:"sortDictionary",value:function(e,r){var i=e.name.toLowerCase(),o=r.name.toLowerCase();return i<o?-1:i>o?1:0}}]),e}();r.default=t},function(e,r,i){r=e.exports=i(4)(),r.push([e.id,'/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}*,:after,:before{box-sizing:border-box;-webkit-tap-highlight-color:transparent}svg{overflow:visible!important}body,html{background-color:#fff;font-family:Open Sans,sans-serif}#App{overflow:hidden;width:100%}.filt-cont{width:24%;height:50px;float:left;margin-top:22px}.dropdown{width:100%;color:#53565a;position:relative;display:inline-block;margin-left:1%;margin-top:10px}.dropdown-content{display:none;position:absolute;background-color:#fff;z-index:1;width:100%;border:1px solid #00a3e0;border-radius:2px;border-top:none;overflow:auto;max-height:300px}.dropdown-content a{color:#53565a;padding:3px 5px;text-decoration:none;display:block;cursor:pointer}.dropdown-content a:hover{background-color:#00a3e0}.dropdown:hover .dropdown-content{display:block}.dropbtn{color:#53565a;background-color:#fff;font-size:14px;border:none;text-align:left;padding-top:3px;padding-bottom:3px;cursor:pointer;width:100%;height:30px;border:1px solid #00a3e0}.drpbtn:focus{outline:none}.heatMapContainer{height:150px;width:74%;margin-left:1%;padding-top:5px;margin-top:10px;float:left}#tooltip{position:absolute;width:auto;text-align:center;border-radius:5px;pointer-events:none;background-color:#fff;padding:8px;z-index:100;font-size:14px;max-width:300px;border:1px solid rgba(0,0,0,.1);box-shadow:4px 4px 6px rgba(0,0,0,.2);z-index:1000}#tooltip span{font-weight:700;font-size:17px}.Title{color:#000;font-size:16px;font-weight:600;padding:12px;text-align:center;text-decoration:underline;width:99%;float:left}.Source{font-weight:300;font-size:14px;padding-left:12px;padding-right:12px;text-align:left}.Source p{margin:2px}svg text{font-size:14px;fill:#53565a;font-weight:400}.app{width:74%;float:left}.Chartcontainer{margin-top:150px;width:100%;float:left}.summary{padding-top:5px;margin-top:2px;height:150px;box-shadow:2px 2px 4px rgba(0,0,0,.247059);position:fixed;width:98%;top:48px;background-color:#fff;margin-left:1%;z-index:1000}.Chartcontainer button{max-width:200px;height:30px;border:none;margin-left:20px;font-family:Open Sans,sans-serif;font-size:16px;font-weight:600;color:#fff}.Chartcontainer button:focus{outline:0}.tick{font-weight:700}.tick line{opacity:.15}.Chartcontainer button:hover{background-color:#fff;color:#000}.legend{width:90%;margin-left:5%;display:inline-flex;justify-content:center;flex-wrap:wrap;float:left}.legend-btn{width:200px;border:2px solid #53565a!important;border-radius:2px}.label{font-size:12px;font-weight:700}.chart-lev{margin-top:50px;width:98%;box-shadow:2px 2px 4px rgba(0,0,0,.247059);margin-left:1%;display:inline-block}.desc{width:24%;float:left;margin-left:1%}.desc-text{height:320px;width:98%;margin-top:40px;padding:5px;font-size:14px;text-align:justify;overflow-y:auto}.desc-text ul{padding-left:10px}.rect{border:2px solid #53565a}.heading{position:fixed;margin-left:1%;width:98%;height:50px;text-align:center;font-size:36px;color:#00a3e0!important;font-weight:800;box-shadow:2px 2px 4px rgba(0,0,0,.247059);z-index:999;background-color:#fff}.heading a,.heading a:focus{color:#00a3e0}.perc-check{height:50px;width:98%;margin-left:1%;display:block;position:relative;padding-left:5px;margin-top:12px;cursor:pointer;font-size:16px;color:#53565a;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.perc-check input{cursor:pointer}.perc-checkinput,.perc-check input{position:absolute;opacity:0}.perc-checkinput+label{position:relative;cursor:pointer;padding:0;width:20px;height:20px}.perc-checkinput+label:before{content:"";margin-right:10px;display:inline-block;vertical-align:text-top;width:20px;height:20px;background:#00a3e0;color:#86bc25;border:1px solid #fff;border-radius:2px}.perc-checkinput:hover+label:before{background:#00a3e0;color:#00a3e0}.perc-checkinput:checked+label:before{color:#00a3e0;background:#00a3e0;border:1px solid #fff;border-radius:2px}.perc-checkinput:disabled+label{color:#63666a;cursor:auto}.perc-checkinput:disabled+label:before{box-shadow:none;background:#00a3e0}.perc-checkinput:checked+label:after{content:"";position:absolute;left:4px;top:8px;background:#fff;width:3px;height:3px;box-shadow:2px 0 0 #fff,4px 0 0 #fff,4px -2px 0 #fff,4px -4px 0 #fff,4px -6px 0 #fff,4px -8px 0 #fff;transform:rotate(45deg)}',""])},function(e,r){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],r=0;r<this.length;r++){var i=this[r];i[2]?e.push("@media "+i[2]+"{"+i[1]+"}"):e.push(i[1])}return e.join("")},e.i=function(r,i){"string"==typeof r&&(r=[[null,r,""]]);for(var o={},t=0;t<this.length;t++){var a=this[t][0];"number"==typeof a&&(o[a]=!0)}for(t=0;t<r.length;t++){var g=r[t];"number"==typeof g[0]&&o[g[0]]||(i&&!g[2]?g[2]=i:i&&(g[2]="("+g[2]+") and ("+i+")"),e.push(g))}},e}},function(e,r,i){function o(e,r){for(var i=0;i<e.length;i++){var o=e[i],t=N[o.id];if(t){t.refs++;for(var a=0;a<t.parts.length;a++)t.parts[a](o.parts[a]);for(;a<o.parts.length;a++)t.parts.push(d(o.parts[a],r))}else{for(var g=[],a=0;a<o.parts.length;a++)g.push(d(o.parts[a],r));N[o.id]={id:o.id,refs:1,parts:g}}}}function t(e){for(var r=[],i={},o=0;o<e.length;o++){var t=e[o],a=t[0],g=t[1],h=t[2],l=t[3],d={css:g,media:h,sourceMap:l};i[a]?i[a].parts.push(d):r.push(i[a]={id:a,parts:[d]})}return r}function a(e,r){var i=m(),o=n[n.length-1];if("top"===e.insertAt)o?o.nextSibling?i.insertBefore(r,o.nextSibling):i.appendChild(r):i.insertBefore(r,i.firstChild),n.push(r);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");i.appendChild(r)}}function g(e){e.parentNode.removeChild(e);var r=n.indexOf(e);r>=0&&n.splice(r,1)}function h(e){var r=document.createElement("style");return r.type="text/css",a(e,r),r}function l(e){var r=document.createElement("link");return r.rel="stylesheet",a(e,r),r}function d(e,r){var i,o,t;if(r.singleton){var a=V++;i=B||(B=h(r)),o=u.bind(null,i,a,!1),t=u.bind(null,i,a,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=l(r),o=y.bind(null,i),t=function(){g(i),i.href&&URL.revokeObjectURL(i.href)}):(i=h(r),o=p.bind(null,i),t=function(){g(i)});return o(e),function(r){if(r){if(r.css===e.css&&r.media===e.media&&r.sourceMap===e.sourceMap)return;o(e=r)}else t()}}function u(e,r,i,o){var t=i?"":o.css;if(e.styleSheet)e.styleSheet.cssText=b(r,t);else{var a=document.createTextNode(t),g=e.childNodes;g[r]&&e.removeChild(g[r]),g.length?e.insertBefore(a,g[r]):e.appendChild(a)}}function p(e,r){var i=r.css,o=r.media;if(o&&e.setAttribute("media",o),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}function y(e,r){var i=r.css,o=r.sourceMap;o&&(i+="\\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var t=new Blob([i],{type:"text/css"}),a=e.href;e.href=URL.createObjectURL(t),a&&URL.revokeObjectURL(a)}var N={},c=function(e){var r;return function(){return"undefined"==typeof r&&(r=e.apply(this,arguments)),r}},s=c(function(){return/msie [6-9]\b/.test(self.navigator.userAgent.toLowerCase())}),m=c(function(){return document.head||document.getElementsByTagName("head")[0]}),B=null,V=0,n=[];e.exports=function(e,r){r=r||{},"undefined"==typeof r.singleton&&(r.singleton=s()),"undefined"==typeof r.insertAt&&(r.insertAt="bottom");var i=t(e);return o(i,r),function(e){for(var a=[],g=0;g<i.length;g++){var h=i[g],l=N[h.id];l.refs--,a.push(l)}if(e){var d=t(e);o(d,r)}for(var g=0;g<a.length;g++){var l=a[g];if(0===l.refs){for(var u=0;u<l.parts.length;u++)l.parts[u]();delete N[l.id]}}}};var b=function(){var e=[];return function(r,i){return e[r]=i,e.filter(Boolean).join("\\n")}}()},function(e,r,i){var o=i(3);"string"==typeof o&&(o=[[e.id,o,""]]);i(5)(o,{});o.locals&&(e.exports=o.locals)}]);
